(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(8339)}])},8339:function(t,e,n){"use strict";n.r(e),n.d(e,{__N_SSG:function(){return V},default:function(){return X}});var r=n(5893),o=n(7294),i=n(6486),u=n.n(i);function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return!e||"object"!==s(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var s=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function f(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var o=a(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return c(this,n)}}var p=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(n,t);var e=f(n);function n(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(r=e.call(this,t)).state={},r}var o=n.prototype;return o.componentDidMount=function(){},o.componentDidUpdate=function(t,e){},o.render=function(){var t=this.props.panel;return(0,r.jsx)("div",{style:{height:5*t.height,width:5*t.width,border:"1px solid black"},children:t.material+"\n"+t.height+"\n"+t.width})},n}(o.Component);function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,e){return!e||"object"!==g(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function b(t,e){return(b=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function y(t){return function(t){if(Array.isArray(t))return d(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var g=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function m(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h(t);if(e){var o=h(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return v(this,n)}}var w=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&b(t,e)}(n,t);var e=m(n);function n(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(r=e.call(this,t)).state={},r}var o=n.prototype;return o.componentDidMount=function(){},o.componentDidUpdate=function(t,e){},o.render=function(){var t=this,e=y(this.props.madePanels).concat(y(this.props.inventoryPanels)),n=u().groupBy(e,(function(t){return t.originalSource}));return(0,r.jsxs)("div",{children:[this.props.notMadePanels.map((function(t){return(0,r.jsx)(p,{panel:t})})),this.props.startPanels.map((function(e){var o=t,i=n[e.id];return 1===i.length?null:(0,r.jsxs)("div",{style:{marginTop:20,pageBreakInside:"avoid",WebkitPrintColorAdjust:"exact"},children:[(0,r.jsxs)("p",{children:[e.label," - ",e.height," x ",e.width]}),(0,r.jsxs)("div",{style:{display:"flex"},children:[(0,r.jsx)("div",{style:{height:5*e.height,width:5*e.width,border:"1px solid black",position:"relative",backgroundColor:"red"},children:i.map((function(t){if(void 0===t.originalSourcePos||t.height<=0||t.width<=0)return null;var e=o.props.inventoryPanels.includes(t),n=e?"":t.id;return(0,r.jsx)("div",{style:{height:5*t.height,width:5*t.width,border:"1px dashed #000",position:"absolute",top:5*t.originalSourcePos.top,left:5*t.originalSourcePos.left,backgroundColor:e?"#ddd":"white",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,r.jsx)("p",{children:n})},t.id)}))}),(0,r.jsx)("div",{style:{marginLeft:10},children:i.map((function(t){return o.props.inventoryPanels.includes(t)?null:(0,r.jsxs)("p",{children:[t.id," - ",t.label," - ",t.height," x"," ",t.width]},t.id)}))})]})]},e.id)}))]})},n}(o.Component);function P(t){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function j(t,e){return!e||"object"!==O(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function x(t,e){return(x=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var O=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function A(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=P(t);if(e){var o=P(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return j(this,n)}}var S,_=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&x(t,e)}(n,t);var e=A(n);function n(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(r=e.call(this,t)).state={},r}var o=n.prototype;return o.componentDidMount=function(){},o.componentDidUpdate=function(t,e){},o.render=function(){var t=this.props.job,e=this.props.result;return void 0===t||void 0===e?"job or result undefined...":(0,r.jsx)("div",{children:(0,r.jsx)(w,{startPanels:t.availablePanels,madePanels:e.panelsMade,inventoryPanels:e.panelInventory,notMadePanels:e.panelsNotPlaced})})},n}(o.Component);!function(t){t[t.VERTICAL=1]="VERTICAL",t[t.HORIZONTAL=2]="HORIZONTAL"}(S||(S={}));var T=1;function D(t,e,n){if(void 0===e)return console.error("cut undefined"),{goodPanel:void 0,wastePanel:void 0};var r=u().cloneDeep(t);r.id=T++;var o,i,a=u().cloneDeep(t);return a.id=T++,a.parentSourcePos={left:0,top:0},a.originalSourcePos=C(t.originalSourcePos,a.parentSourcePos),a.parentSource=t.id,a.originalSource=null!==(o=t.originalSource)&&void 0!==o?o:t.id,e.cutDirection===S.HORIZONTAL?(r.height-=e.cutPosition+n.bladeKerf,r.parentSourcePos={top:e.cutPosition+n.bladeKerf,left:0},a.height=e.cutPosition):(r.width-=e.cutPosition+n.bladeKerf,r.parentSourcePos={top:0,left:e.cutPosition+n.bladeKerf},a.width=e.cutPosition),r.height=Math.max(r.height,0),r.width=Math.max(r.width,0),r.originalSourcePos=C(t.originalSourcePos,r.parentSourcePos),r.parentSource=t.id,r.originalSource=null!==(i=t.originalSource)&&void 0!==i?i:t.id,{goodPanel:a,wastePanel:r}}function C(t,e){return void 0===t&&(t={top:0,left:0}),void 0===e&&(e={top:0,left:0}),{left:t.left+e.left,top:t.top+e.top}}function R(t,e,n){var r=t.height-e.height,o=t.width-e.width,i=r<0||o<0,u=t.height-e.width,a=t.width-e.height,c=u>=0&&a>=0,l=k(e.width,e.height,t,n),s=k(e.height,e.width,t,n);return i?s.cuts:!c||l.biggestArea>s.biggestArea?l.cuts:s.cuts}function k(t,e,n,r){var o=n.width-t>.001,i=n.height-e>.001,u=r.bladeKerf,a={cutDirection:S.VERTICAL,cutPosition:t,panelIdToCut:n.id},c={cutDirection:S.HORIZONTAL,cutPosition:e,panelIdToCut:n.id};if(i&&o){var l=Math.max(e*(n.width-t-u),(n.height-e-u)*n.width),s=Math.max(t*(n.height-e-u),(n.width-t-u)*n.height),f=n.width+e,p=n.height+t;return r.optimizeArea?l>s?{cuts:[c,a],biggestArea:l}:{cuts:[a,c],biggestArea:s}:p>f?{cuts:[c,a],biggestArea:-f}:{cuts:[a,c],biggestArea:-p}}return o?{cuts:[a],biggestArea:Number.MAX_VALUE/2}:i?{cuts:[c],biggestArea:Number.MAX_VALUE/2}:{cuts:[],biggestArea:Number.MAX_VALUE}}function E(t,e){var n=M(t),r=n.bigDim,o=n.smallDim,i=M(e),u=i.bigDim,a=i.smallDim;return u===r||a===o||u===o||a===r?1:u/r*a/o}function I(t,e){var n=M(t),r=n.bigDim,o=n.smallDim,i=M(e),u=i.bigDim,a=i.smallDim;return r>u?-1:r<u?1:o>a?-1:o<a?1:0}function M(t){return{bigDim:Math.max(t.height,t.width),smallDim:Math.min(t.height,t.width)}}function N(t,e,n){var r=M(t),o=r.bigDim,i=r.smallDim,u=M(e),a=u.bigDim,c=u.smallDim;return o>=a&&i>=c}var L=/[^0-9.]/g;function B(t){return function(e){return t(e.target.value)}}var z=function(t){void 0===t&&(t={});var e=(0,o.useState)(t),n=e[0],r=e[1];return[n,(0,o.useCallback)((function(t){r((function(e){return Object.assign({},e,t instanceof Function?t(e):t)}))}),[])]};function U(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function K(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],u=!0,a=!1;try{for(n=n.call(t);!(u=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);u=!0);}catch(c){a=!0,o=c}finally{try{u||null==n.return||n.return()}finally{if(a)throw o}}return i}}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return U(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var V=!0;function X(t){var e,n=function(){var t=function(t){T=1;var e=t.split("\n"),n={availablePanels:[],neededPanels:[],settings:{bladeKerf:.25,optimizeArea:!1}},r=!0,o=!0,i=!1,u=void 0;try{for(var a,c=e[Symbol.iterator]();!(o=(a=c.next()).done);o=!0){var l=a.value;if(r)r=!1;else if(""!==l.trim()){var s,f=l.split(","),p=+f[0].replaceAll(L,""),d=+f[1].replaceAll(L,""),h=+f[2],v=f[3],b=f[4],y="true"===f[5].trim().toLowerCase();p>d&&(p=(s=[d,p])[0],d=s[1]);for(var g=1;g<=h;g++){var m={height:p,width:d,id:T++,material:v,label:h>1?b+"-"+g:b};y?n.availablePanels.push(m):n.neededPanels.push(m)}}}}catch(w){i=!0,u=w}finally{try{o||null==c.return||c.return()}finally{if(i)throw u}}return n}(i.inputText);t.settings.bladeKerf=+i.kerfText,t.settings.optimizeArea=i.optimizeArea,console.log("job start",t);var e=function(t){var e=u().cloneDeep(t.availablePanels);e.forEach((function(t){t.originalSource=t.id,t.parentSource=t.id}));var n=u().cloneDeep(t.neededPanels);n.sort(I);for(var r=[],o=[],i=[];n.length;){var a=n.shift();if(void 0===a){console.log("panel was undefined");break}var c=e.filter((function(t){return t.material===a.material})).filter((function(e){return N(e,a,t.settings)}));if(0!==c.length){var l=u().maxBy(c,(function(t){return E(t,a)}));if(void 0===l){console.error("could not find best");break}u().remove(e,(function(t){return t.id===l.id}));var s=R(l,a,t.settings);if(0!==s.length){var f=s[0],p=D(l,f,t.settings),d=p.goodPanel,h=p.wastePanel;if(void 0===d){console.error("failed on a cut?");break}d.label=a.label,i.push(f),h&&e.push(h);var v=s[1];if(void 0!==v){var b=D(d,v,t.settings),y=b.goodPanel,g=b.wastePanel;if(void 0===y){console.warn("panel was undefined?");break}o.push(y),g&&e.push(g),i.push(v)}else o.push(d)}else o.push(l)}else r.push(a),console.log("could not place",a)}return{panelInventory:e,panelsMade:o,panelsNotPlaced:r,cutsInOrder:i}}(t);console.log("result",e),a({job:t,results:e})},o=K(z({inputText:t.defaultText,job:void 0,results:void 0,kerfText:"0.25",optimizeArea:!1}),2),i=o[0],a=o[1];return(0,r.jsxs)("div",{id:"container",children:[(0,r.jsx)("h1",{children:"sheet cutter (Next.js version)"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("textarea",{value:i.inputText,onChange:B((function(t){return a({inputText:t})}))}),(0,r.jsx)("input",{value:i.kerfText,onChange:B((function(t){return a({kerfText:t})}))}),(0,r.jsxs)("p",{children:[(0,r.jsx)("input",{type:"checkbox",checked:i.optimizeArea,onChange:(e=function(t){return a({optimizeArea:t})},function(t){return e(t.target.checked)})}),"optimize area?"]}),(0,r.jsx)("button",{onClick:function(){return n()},children:"process !"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{children:"results"}),(0,r.jsx)(_,{job:i.job,result:i.results})]})]})}}},function(t){t.O(0,[662,774,888,179],(function(){return e=8312,t(t.s=e);var e}));var e=t.O();_N_E=e}]);